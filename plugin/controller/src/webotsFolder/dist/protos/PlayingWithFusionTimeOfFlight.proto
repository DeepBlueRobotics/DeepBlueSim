#VRML_SIM R2023b utf8

# license: WPILib BSD
# license url: https://github.com/wpilibsuite/allwpilib/blob/main/LICENSE.md

PROTO PlayingWithFusionTimeOfFlight [
    unconnectedField SFInt32 port       0

    # Expose fields from Solid and Pose
    field SFVec3f    translation         0 0 0
    field SFRotation rotation            1 0 0 -1.5708
    field SFFloat    translationStep     0.01
    field SFFloat    rotationStep        0.261799387
    field SFNode{Appearance{},PBRAppearance{}} appearance PBRAppearance {
        baseColor 0 0 0
        metalness 0
    }
    field SFNode{Physics{}} physics      NULL
    field SFBool     locked              FALSE
    field SFString   contactMaterial     "default"
    field MFNode{ImmersionProperties{}} immersionProperties []
    field SFFloat    radarCrossSection   0.0
    field MFColor    recognitionColors   []
]
{
    DistanceSensor {
        # General
        name %<= '"DBSim_PlayingWithFusionTimeOfFlight_' + fields.port.value + '"' >%
        model "PlayingWithFusion-TimeOfFlightSensor"
        description  %<= '"DeepBlueSim Playing With Fusion Time Of Flight Sensor on CAN Port ' + fields.port.value + '"' >%

        # Model
        boundingObject Pose {
            translation -0.004953 0 0
            children [
                Box {
                    size 0.009906 0.055538 0.01559
                }
            ]
        }
        children [
            Pose {
                translation -0.009906 0 0
                rotation 0.577351 -0.57735 -0.57735 2.09439
                children [
                    Shape {
                        appearance IS appearance
                        geometry Mesh {
                            url "../models/PlayingWithFusionTimeOfFlight.stl"
                        }
                    }
                ]
            }
        ]

        # Sensor
        lookupTable [ 0 0 0 ] # Set by PlayingWithFusionTimeOfFlightMediator.java
        type "infra-red"
        numberOfRays 4
        aperture 0.471 # 27 degrees
        gaussianWidth 1
        resolution 0.001 # 1mm
        redColorSensitivity 1

        # Misc
        translation IS translation
        rotation IS rotation
        translationStep IS translationStep
        rotationStep IS rotationStep
        physics IS physics
        locked IS locked
        contactMaterial IS contactMaterial
        immersionProperties IS immersionProperties
        radarCrossSection IS radarCrossSection
        recognitionColors IS recognitionColors
    }
}
